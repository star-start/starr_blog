{"remainingRequest":"F:\\Spring Boot\\STAR-BLOG\\vue-starblog\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\Spring Boot\\STAR-BLOG\\vue-starblog\\src\\view\\manage\\comment\\Comment.vue?vue&type=style&index=0&id=ac77e874&scoped=true&lang=css&","dependencies":[{"path":"F:\\Spring Boot\\STAR-BLOG\\vue-starblog\\src\\view\\manage\\comment\\Comment.vue","mtime":1672399210835},{"path":"F:\\Spring Boot\\STAR-BLOG\\vue-starblog\\node_modules\\css-loader\\dist\\cjs.js","mtime":1672420949353},{"path":"F:\\Spring Boot\\STAR-BLOG\\vue-starblog\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1672420953476},{"path":"F:\\Spring Boot\\STAR-BLOG\\vue-starblog\\node_modules\\postcss-loader\\src\\index.js","mtime":1672420950940},{"path":"F:\\Spring Boot\\STAR-BLOG\\vue-starblog\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1672420947809},{"path":"F:\\Spring Boot\\STAR-BLOG\\vue-starblog\\node_modules\\vue-loader\\lib\\index.js","mtime":1672420951796}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgouaGFuZGxlLWlucHV0IHsKICB3aWR0aDogMjUwcHg7CiAgZGlzcGxheTogaW5saW5lLWJsb2NrOwp9CgoubXIxMCB7CiAgbWFyZ2luLXJpZ2h0OiAxMHB4OwogIG1hcmdpbi1ib3R0b206IDEwcHg7Cn0KCi5oYW5kbGUtc2VsZWN0IHsKICB3aWR0aDogMTAwcHg7Cn0KCg=="},{"version":3,"sources":["Comment.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyRA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"Comment.vue","sourceRoot":"src/view/manage/comment","sourcesContent":["<template>\r\n  <div>\r\n    <div class=\"container\">\r\n      <div class=\"handle-box\">\r\n        <el-input v-model=\"query.titleKeyword\" placeholder=\"通过文章标题搜索\" class=\"handle-input mr10\"></el-input>\r\n        <el-input v-model=\"query.contentKeyword\" placeholder=\"通过评论搜索\" class=\"handle-input mr10\"></el-input>\r\n        <el-select @change=\"changeSelection\" v-model=\"query.status\" placeholder=\"评论状态\" class=\"handle-select mr10\">\r\n          <el-option key=\"-1\" label=\"全部评论\" :value=\"-1\"></el-option>\r\n          <el-option key=\"1\" label=\"已发布\" :value=\"1\"></el-option>\r\n          <el-option key=\"2\" label=\"待审核\" :value=\"2\"></el-option>\r\n          <el-option key=\"0\" label=\"回收站\" :value=\"0\"></el-option>\r\n        </el-select>\r\n        <el-button type=\"primary\" @click=\"handleSearch\">搜索</el-button>\r\n        <el-button type=\"info\" plain @click=\"handleClear\">重置</el-button>\r\n        <el-switch\r\n                v-if=\"this.$store.getters.isAdmin\"\r\n                v-model=\"enableAdmin\"\r\n                style=\"display: inline-block;font-size: 12px;float: right;\"\r\n                active-text=\"开启管理员模式\"\r\n                active-color=\"#13ce66\"\r\n                inactive-color=\"#d5dce6\"\r\n                @change=\"getComments\"\r\n        >\r\n        </el-switch>\r\n      </div>\r\n      <el-table\r\n              v-loading=\"loading\"\r\n              :data=\"comments\"\r\n              border\r\n              class=\"table\"\r\n              ref=\"multipleTable\"\r\n              header-cell-class-name=\"table-header\"\r\n      >\r\n        <el-table-column type=\"selection\" width=\"55\" align=\"center\"></el-table-column>\r\n        <el-table-column prop=\"commentatorName\" label=\"昵称\" width=\"100\" align=\"left\">\r\n          <template slot-scope=\"scope\">\r\n            <el-tooltip  effect=\"light\"  placement=\"right-end\" >\r\n              <div slot=\"content\">name:{{scope.row.commentatorName}}<br/>\r\n                email:{{scope.row.commentatorEmail}}<br/>\r\n                location:{{scope.row.commentatorLocation}}\r\n              </div>\r\n              <el-button  type=\"text\" icon=\"el-icon-user\" >{{scope.row.commentatorName}}</el-button>\r\n            </el-tooltip>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"commentContent\" label=\"内容\" align=\"center\"></el-table-column>\r\n        <el-table-column label=\"状态\" align=\"center\" width=\"120\">\r\n          <template slot-scope=\"scope\">\r\n            <el-tag :type=\"scope.row.status=== 1?'success':(scope.row.status=== 0?'danger':'warning')\"\r\n            >\r\n              {{scope.row.status=== 1?'已发布':(scope.row.status=== 0?'回收站':'待审核')}}\r\n            </el-tag>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"title\" label=\"评论文章\" align=\"center\"></el-table-column>\r\n        <el-table-column v-if=\"enableAdmin\"  label=\"文章作者\" align=\"center\">\r\n          <template slot-scope=\"scope\">\r\n            <el-tooltip  effect=\"light\"  placement=\"right-end\" >\r\n              <div slot=\"content\">UID:{{scope.row.userId}}\r\n              </div>\r\n              <el-button\r\n                      type=\"text\"\r\n                      icon=\"el-icon-user\"\r\n                      size=\"mini\"\r\n                      style=\"color: #6ffcff\"\r\n                      @click=\"selectByUserId(scope.row.userId)\"\r\n              >{{scope.row.nickname}}\r\n              </el-button>\r\n            </el-tooltip>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"commentCreateTime\" label=\"评论时间\" align=\"center\"></el-table-column>\r\n        <el-table-column label=\"操作\" width=\"180\" align=\"center\">\r\n          <template slot-scope=\"scope\">\r\n            <el-button\r\n                    type=\"text\"\r\n                    icon=\"el-icon-edit\"\r\n                    @click=\"handleEdit(scope.$index, scope.row)\"\r\n            >{{scope.row.status == 2 ? '通过': scope.row.status == 0?'还原':scope.row.replyContent!=''?'查看回复':'回复'}}\r\n            </el-button>\r\n            <el-button\r\n                    type=\"text\"\r\n                    icon=\"el-icon-delete\"\r\n                    style=\"color: red\"\r\n                    @click=\"handleDelete(scope.$index, scope.row)\"\r\n            >{{scope.row.status!=0?'回收站':'删除'}}\r\n            </el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      <div class=\"pagination\">\r\n        <el-pagination\r\n                style=\"display: inline-block; padding: 0px\"\r\n                background\r\n                layout=\"total, prev, pager, next\"\r\n                :current-page=\"query.curPage\"\r\n                :page-size=\"query.pageSize\"\r\n                :total=\"pageTotal\"\r\n                @current-change=\"handlePageChange\"\r\n        ></el-pagination>\r\n        <el-select @change=\"changeSelection\" v-model=\"query.pageSize\" placeholder=\"评论状态\" class=\"handle-select\">\r\n          <el-option key=\"0\" label=\"5条/页\" :value=\"5\"></el-option>\r\n          <el-option key=\"1\" label=\"7条/页\" :value=\"7\"></el-option>\r\n          <el-option key=\"2\" label=\"10条/页\" :value=\"10\"></el-option>\r\n          <el-option key=\"3\" label=\"20条/页\" :value=\"20\"></el-option>\r\n          <el-option key=\"4\" label=\"50条/页\" :value=\"50\"></el-option>\r\n        </el-select>\r\n      </div>\r\n\r\n      <el-dialog :title=\"'回复：'+commentatorName\" :visible.sync=\"edit\" width=\"30%\">\r\n        <el-input\r\n                type=\"textarea\"\r\n                :rows=\"8\"\r\n                placeholder=\"\"\r\n                v-model=replyContent\r\n                maxlength=\"150\"\r\n                show-word-limit\r\n        >\r\n        </el-input>\r\n        <p v-if=\"needEdit\" style=\"margin-top: 20px;text-align: right\">{{'回复于：'+ replyCreateTime}}</p>\r\n        <el-button style=\"margin-top: 20px\" type=\"info\" plain @click=\"replyContent=''\">重 置</el-button>\r\n        <el-button type=\"primary\" @click=\"saveEdit\">{{needEdit?'修 改':'确 定'}}</el-button>\r\n      </el-dialog>\r\n    </div>\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import { deleteRequest, getRequest, putRequest } from '@/axios';\r\n  import { getFormatTime } from '@/utils/timeFormat';\r\n\r\n\r\nexport default {\r\n    name: 'Comment',\r\n    data() {\r\n      return {\r\n        query: {\r\n          titleKeyword: '',\r\n          contentKeyword: '',\r\n          status: -1,\r\n          curPage: 1,\r\n          pageSize: 7\r\n        },\r\n\r\n        comments: [],\r\n\r\n        loading: false,\r\n        pageTotal: 0,\r\n\r\n        edit: false,\r\n        needEdit: false,\r\n        commentatorName: '',\r\n        replyContent: '',\r\n        replyCreateTime: '',\r\n\r\n        enableAdmin: false,\r\n        adminSelectUserId: -1\r\n      }\r\n    },\r\n\r\n    created() {\r\n      this.getComments();\r\n    },\r\n\r\n    methods: {\r\n      getComments() {\r\n        this.loading = true;\r\n        getRequest(this.enableAdmin?'/admin/all/comment/?userId='+ this.adminSelectUserId + '&':'/comment/all', this.query).then(resp => {\r\n          this.loading = false;\r\n          if (resp.status == 200) {\r\n            this.comments = resp.data.list;\r\n            this.pageTotal = resp.data.total;\r\n          }\r\n        }, err => {\r\n          this.loading = false;\r\n        }).catch(err => {\r\n          this.loading = false;\r\n          this.$message.error('操作失败');\r\n        });\r\n      },\r\n\r\n      handleSearch(){\r\n        this.query.curPage = 1;\r\n        this.getComments();\r\n      },\r\n\r\n      selectByUserId(userId) {\r\n        this.adminSelectUserId = userId;\r\n        this.getComments();\r\n      },\r\n\r\n      handleClear(){\r\n        this.query.titleKeyword = '';\r\n        this.query.contentKeyword = '';\r\n        this.query.status = -1;\r\n        this.query.curPage = 1;\r\n        this.adminSelectUserId = -1;\r\n        this.getComments();\r\n      },\r\n\r\n      changeSelection() {\r\n        this.query.curPage = 1;\r\n        this.getComments();\r\n      },\r\n\r\n      handlePageChange(val) {\r\n        this.$set(this.query, 'curPage', val);\r\n        this.getComments();\r\n      },\r\n\r\n      handleEdit(index, row) {\r\n        if (row.status != 1) {\r\n          this.changeStatus(row.commentId,1);\r\n        }else{\r\n          this.edit = true;\r\n          if (row.replyContent){\r\n            this.needEdit = true;\r\n            this.replyCreateTime = getFormatTime(row.replyCreateTime);\r\n            this.replyContent = row.replyContent;\r\n          }else{\r\n            this.replyContent = '';\r\n            this.needEdit = false;\r\n          }\r\n          this.commentId = row.commentId;\r\n          this.commentatorName = row.commentatorName;\r\n        }\r\n      },\r\n\r\n      saveEdit() {\r\n        putRequest('/comment/reply/', {\r\n          commentId: this.commentId,\r\n          replyContent: this.replyContent\r\n        }).then(resp => {\r\n          if (resp.status == 200) {\r\n            if (resp.data.status == 'success') {\r\n              this.edit = false;\r\n              this.replyContent = '';\r\n              this.getComments();\r\n            }\r\n          }\r\n        })\r\n      },\r\n\r\n      handleDelete(index, row) {\r\n        if (row.status == 0) {\r\n          deleteRequest('/comment/', {\r\n            commentId: row.commentId\r\n          }).then(resp => {\r\n            if (resp.status == 200) {\r\n              if (resp.data.status == 'success') {\r\n                this.getComments();\r\n              }\r\n            }\r\n          })\r\n        } else {\r\n          this.changeStatus(row.commentId, 0);\r\n        }\r\n      },\r\n\r\n\r\n      changeStatus(commentId, status) {\r\n        putRequest('/comment/status', {\r\n          commentId:commentId,\r\n          status:status\r\n        }).then(resp => {\r\n          if (resp.status == 200) {\r\n            if (resp.data.status == 'success') {\r\n              this.getComments();\r\n            }\r\n          }\r\n        })\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n</script>\r\n\r\n<style scoped>\r\n  .handle-input {\r\n    width: 250px;\r\n    display: inline-block;\r\n  }\r\n\r\n  .mr10 {\r\n    margin-right: 10px;\r\n    margin-bottom: 10px;\r\n  }\r\n\r\n  .handle-select {\r\n    width: 100px;\r\n  }\r\n\r\n</style>\r\n"]}]}