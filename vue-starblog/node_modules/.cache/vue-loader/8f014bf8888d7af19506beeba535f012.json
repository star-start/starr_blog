{"remainingRequest":"F:\\Spring Boot\\STAR-BLOG\\vue-starblog\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\Spring Boot\\STAR-BLOG\\vue-starblog\\src\\view\\manage\\admin\\UserManager.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\Spring Boot\\STAR-BLOG\\vue-starblog\\src\\view\\manage\\admin\\UserManager.vue","mtime":1672399210832},{"path":"F:\\Spring Boot\\STAR-BLOG\\vue-starblog\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1672420947809},{"path":"F:\\Spring Boot\\STAR-BLOG\\vue-starblog\\node_modules\\babel-loader\\lib\\index.js","mtime":1672420951357},{"path":"F:\\Spring Boot\\STAR-BLOG\\vue-starblog\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1672420947809},{"path":"F:\\Spring Boot\\STAR-BLOG\\vue-starblog\\node_modules\\vue-loader\\lib\\index.js","mtime":1672420951796}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGRlbGV0ZVJlcXVlc3QsIGdldFJlcXVlc3QsIHB1dFJlcXVlc3QgfSBmcm9tICdAL2F4aW9zJzsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnVXNlck1hbmFnZXInLAoKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgcXVlcnk6IHsKICAgICAgICBuaWNrbmFtZUtleXdvcmQ6ICcnLAogICAgICAgIHN0YXR1czogMSwKICAgICAgICBjdXJQYWdlOiAxLAogICAgICAgIHBhZ2VTaXplOiAxMgogICAgICB9LAoKICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgIHNpbmdsZUxvYWRpbmdzOiBbXSwKCiAgICAgIHVzZXJzOiBbXSwKCiAgICAgIHRhZ1R5cGU6IFsnZGFuZ2VyJywgJ3N1Y2Nlc3MnLCAnd2FybmluZycsICdwcmltYXJ5J10sCgogICAgICBhbGxSb2xlczogW10sCiAgICAgIHJvbGVJZHM6IFtdCiAgICB9OwogIH0sCgoKICBjcmVhdGVkKCkgewogICAgdGhpcy5zaW5nbGVMb2FkaW5ncyA9IEFycmF5LmFwcGx5KG51bGwsIEFycmF5KDEyKSkubWFwKGZ1bmN0aW9uKGl0ZW0sIGkpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSk7CiAgICB0aGlzLmdldFVzZXJzKCk7CiAgICB0aGlzLmdldEFsbFJvbGVzKCk7CiAgfSwKCiAgbWV0aG9kczogewogICAgZ2V0VXNlcnMoKSB7CiAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7CiAgICAgIGdldFJlcXVlc3QoJy9hZG1pbi91c2VyL2FsbCcsIHRoaXMucXVlcnkpLnRoZW4ocmVzcCA9PiB7CiAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICAgICAgaWYgKHJlc3Auc3RhdHVzID09IDIwMCkgewogICAgICAgICAgdGhpcy51c2VycyA9IHJlc3AuZGF0YS5saXN0OwogICAgICAgIH0KICAgICAgfSwgZXJyID0+IHsKICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgfSkuY2F0Y2goZXJyID0+IHsKICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgfSk7CiAgICB9LAoKCiAgICBnZXRBbGxSb2xlcygpIHsKICAgICAgZ2V0UmVxdWVzdCgnL2FkbWluL3JvbGUvYWxsJykudGhlbihyZXNwID0+IHsKICAgICAgICBpZiAocmVzcC5zdGF0dXMgPT0gMjAwKSB7CiAgICAgICAgICB0aGlzLmFsbFJvbGVzID0gcmVzcC5kYXRhOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAoKCiAgICBjaGFuZ2VTdGF0dXModXNlcklkLCBzdGF0dXMsIGluZGV4LCBpc05ld1VzZXIpIHsKICAgICAgdGhpcy5zaW5nbGVMb2FkaW5ncy5zcGxpY2UoaW5kZXgsIDEsIHRydWUpOwogICAgICBwdXRSZXF1ZXN0KCcvYWRtaW4vdXNlci9zdGF0dXMnLCB7CiAgICAgICAgdXNlcklkOiB1c2VySWQsCiAgICAgICAgc3RhdHVzOiBzdGF0dXMsCiAgICAgICAgaXNOZXdVc2VyOiBpc05ld1VzZXIKICAgICAgfSkudGhlbihyZXNwID0+IHsKICAgICAgICBpZiAocmVzcC5zdGF0dXMgPT0gMjAwKSB7CiAgICAgICAgICB0aGlzLnNpbmdsZUxvYWRpbmdzLnNwbGljZShpbmRleCwgMSwgZmFsc2UpOwogICAgICAgICAgdGhpcy5nZXRVc2VycygpOwogICAgICAgIH0KICAgICAgfSkKICAgIH0sCgogICAgaGFuZGxlRGVsZXRlKHVzZXJJZCkgewogICAgICB0aGlzLiRjb25maXJtKCfliKDpmaTor6XnlKjmiLfvvIzmmK/lkKbnu6fnu60/JywgJ+aPkOekuicsIHsKICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+ehruWumicsCiAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ+WPlua2iCcsCiAgICAgICAgdHlwZTogJ3dhcm5pbmcnCiAgICAgIH0pLnRoZW4oKCkgPT4gewogICAgICAgIHRoaXMuJGNvbmZpcm0oJ+ivpeeUqOaIt+S4i+eahOaJgOacieaWh+eroOOAgeWIhuexu+OAgeivhOiuuuWdh+S8muiiq+WIoOmZpO+8jOaYr+WQpue7p+e7rT8nLCAn5o+Q56S6JywgewogICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfnoa7lrponLAogICAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ+WPlua2iCcsCiAgICAgICAgICB0eXBlOiAnaW5mbycKICAgICAgICB9KS50aGVuKCgpID0+IHsKICAgICAgICAgIGRlbGV0ZVJlcXVlc3QoJy9hZG1pbi91c2VyLycgKyB1c2VySWQpLnRoZW4ocmVzcCA9PiB7CiAgICAgICAgICAgIGlmIChyZXNwLnN0YXR1cyA9PSAyMDApIHsKICAgICAgICAgICAgICB0aGlzLmdldFVzZXJzKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pCiAgICAgICAgfSkKICAgICAgfSkKICAgIH0sCgogICAgc2hvd1JvbGVJZHMocm9sZXMpIHsKICAgICAgdGhpcy5yb2xlSWRzID0gW107CiAgICAgIHJvbGVzLmZvckVhY2goKGl0ZW0sIGluZGV4KSA9PiB7CiAgICAgICAgdGhpcy5yb2xlSWRzLnB1c2goaXRlbS5yb2xlSWQpOwogICAgICB9KTsKICAgIH0sCgogICAgY2hhbmdlUm9sZXMocm9sZUlkcywgdXNlcklkLCBpbmRleCkgewoKICAgICAgaWYgKHJvbGVJZHMubGVuZ3RoID09IDApIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfop5LoibLkuI3lj6/kuLrnqbonKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgcHV0UmVxdWVzdCgnL2FkbWluL3VzZXIvcm9sZXMnLCB7CiAgICAgICAgcm9sZUlkczogcm9sZUlkcywKICAgICAgICB1c2VySWQ6IHVzZXJJZAogICAgICB9KS50aGVuKHJlc3AgPT4gewogICAgICAgIGlmIChyZXNwLnN0YXR1cyA9PSAyMDApIHsKICAgICAgICAgIHRoaXMuZ2V0VXNlckJ5VXNlcklkKHVzZXJJZCwgaW5kZXgpOwogICAgICAgIH0KICAgICAgfSkKICAgIH0sCgogICAgZ2V0VXNlckJ5VXNlcklkKHVzZXJJZCwgaW5kZXgpIHsKICAgICAgLy9zcGxpY2XluKbliLfmlrDlip/og73vvIjkvZPpqozlvpcuLgogICAgICB0aGlzLnNpbmdsZUxvYWRpbmdzLnNwbGljZShpbmRleCwgMSwgdHJ1ZSk7CiAgICAgIGdldFJlcXVlc3QoJy9hZG1pbi91c2VyLycgKyB1c2VySWQpLnRoZW4ocmVzcCA9PiB7CiAgICAgICAgaWYgKHJlc3Auc3RhdHVzID09IDIwMCkgewogICAgICAgICAgdGhpcy5zaW5nbGVMb2FkaW5ncy5zcGxpY2UoaW5kZXgsIDEsIGZhbHNlKTsKICAgICAgICAgIHRoaXMudXNlcnMuc3BsaWNlKGluZGV4LCAxLCByZXNwLmRhdGEpOwogICAgICAgIH0KICAgICAgfSkKICAgIH0KCiAgfQp9Owo="},{"version":3,"sources":["UserManager.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsGA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"UserManager.vue","sourceRoot":"src/view/manage/admin","sourcesContent":["<template>\r\n  <div class=\"container\">\r\n    <div class=\"user-manager-body\" v-loading=\"loading\">\r\n      <el-row style=\"margin-bottom: 10px\">\r\n        <el-col :xs=\"24\" :sm=\"24\" :md=\"24\" :lg=\"24\" :xl=\"24\" >\r\n          <el-radio-group v-model=\"query.status\" @change=\"getUsers()\" style=\"margin-right: 40px;text-align: left;\">\r\n            <el-radio :label=\"1\">已注册</el-radio>\r\n            <el-radio :label=\"2\">待审核</el-radio>\r\n          </el-radio-group>\r\n          <el-input v-model=\"query.nicknameKeyword\" placeholder=\"通过用户昵称搜索\" class=\"input-body\"></el-input>\r\n          <el-button type=\"primary\" style=\"display: inline-block;\" icon=\"el-icon-search\" @click=\"getUsers()\">搜索\r\n          </el-button>\r\n        </el-col>\r\n      </el-row>\r\n\r\n\r\n      <el-row :gutter=\"20\">\r\n        <el-col v-for=\"(user,index) in users\" :xs=\"12\" :sm=\"12\" :md=\"12\" :lg=\"6\" :xl=\"6\"\r\n                :key=\"user.username\"\r\n                v-loading=\"singleLoadings[index]\" style=\"margin-bottom:20px\">\r\n          <el-card class=\"box-card\">\r\n            <div slot=\"header\" class=\"clearfix\">\r\n              <span>{{user.nickname}}</span>\r\n              <el-button @click=\"handleDelete(user.userId)\"\r\n                         class=\"delete-button\"\r\n                         icon=\"el-icon-delete\"\r\n                         type=\"text\">删除\r\n              </el-button>\r\n            </div>\r\n            <div class=\"form-body\">\r\n              <p class=\"pText\">用户名：{{user.username}}</p>\r\n              <p class=\"pText\">性别：{{user.gender == 1? '男':'女'}}</p>\r\n              <p class=\"pText\">邮箱：{{user.email}}</p>\r\n              <p class=\"pText\">注册时间：{{user.registerTime}}</p>\r\n              <div v-if=\"query.status!=2\">\r\n                <div style=\"margin-bottom: 15px\">\r\n                  <p class=\"pText\" style=\"display: inline\">\r\n                    状态：\r\n                  </p>\r\n                  <el-switch\r\n                          v-model=\"user.status\"\r\n                          style=\"display: inline-block;font-size: 12px\"\r\n                          active-text=\"启用\"\r\n                          inactive-text=\"封禁\"\r\n                          :active-value=\"1\"\r\n                          :inactive-value=\"0\"\r\n                          active-color=\"#13ce66\"\r\n                          inactive-color=\"#ff4949\"\r\n                          @change=\"changeStatus(user.userId,user.status,index,false)\"\r\n                  >\r\n                  </el-switch>\r\n                </div>\r\n                <div style=\"margin-bottom: 15px\">\r\n                  <p class=\"pText\" style=\"display: inline\">\r\n                    角色：\r\n                  </p>\r\n                  <el-tag v-for=\"(item,index) in user.roles\"\r\n                          :key=\"item.roleId\"\r\n                          :type=\"tagType[item.roleId -1]\"\r\n                          size=\"mini\"\r\n                          class=\"fa fa-user\"\r\n                          style=\"margin: 0px 2px\"\r\n                  > {{item.roleNameZh}}\r\n                  </el-tag>\r\n\r\n                  <el-popover\r\n                          placement=\"right-end\"\r\n                          width=\"160\"\r\n                          @hide=\"changeRoles(roleIds,user.userId,index)\"\r\n                  >\r\n                    <p class=\"pText\">更改角色</p>\r\n                    <el-select v-model=\"roleIds\" multiple placeholder=\"请选择\" size=\"mini\">\r\n                      <el-option\r\n                              v-for=\"(item,index) in allRoles\"\r\n                              :key=\"item.roleId\"\r\n                              :label=\"item.roleNameZh\"\r\n                              :value=\"item.roleId\">\r\n                      </el-option>\r\n                    </el-select>\r\n                    <el-button type=\"text\" size=\"mini\" icon=\"fa fa-plus-square\"\r\n                               style=\"color: #f07724;\" slot=\"reference\" @click=\"showRoleIds(user.roles)\"></el-button>\r\n                  </el-popover>\r\n                </div>\r\n              </div>\r\n              <div v-else>\r\n                <el-button type=\"warning\" icon=\"fa fa-futbol-o\" @click=\"changeStatus(user.userId,1,index, true)\"> 审核通过\r\n                </el-button>\r\n              </div>\r\n            </div>\r\n\r\n          </el-card>\r\n        </el-col>\r\n\r\n\r\n      </el-row>\r\n\r\n\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import { deleteRequest, getRequest, putRequest } from '@/axios';\r\n\r\n  export default {\r\n    name: 'UserManager',\r\n\r\n    data() {\r\n      return {\r\n        query: {\r\n          nicknameKeyword: '',\r\n          status: 1,\r\n          curPage: 1,\r\n          pageSize: 12\r\n        },\r\n\r\n        loading: false,\r\n        singleLoadings: [],\r\n\r\n        users: [],\r\n\r\n        tagType: ['danger', 'success', 'warning', 'primary'],\r\n\r\n        allRoles: [],\r\n        roleIds: []\r\n      };\r\n    },\r\n\r\n\r\n    created() {\r\n      this.singleLoadings = Array.apply(null, Array(12)).map(function(item, i) {\r\n        return false;\r\n      });\r\n      this.getUsers();\r\n      this.getAllRoles();\r\n    },\r\n\r\n    methods: {\r\n      getUsers() {\r\n        this.loading = true;\r\n        getRequest('/admin/user/all', this.query).then(resp => {\r\n          this.loading = false;\r\n          if (resp.status == 200) {\r\n            this.users = resp.data.list;\r\n          }\r\n        }, err => {\r\n          this.loading = false;\r\n        }).catch(err => {\r\n          this.loading = false;\r\n        });\r\n      },\r\n\r\n\r\n      getAllRoles() {\r\n        getRequest('/admin/role/all').then(resp => {\r\n          if (resp.status == 200) {\r\n            this.allRoles = resp.data;\r\n          }\r\n        });\r\n      },\r\n\r\n\r\n      changeStatus(userId, status, index, isNewUser) {\r\n        this.singleLoadings.splice(index, 1, true);\r\n        putRequest('/admin/user/status', {\r\n          userId: userId,\r\n          status: status,\r\n          isNewUser: isNewUser\r\n        }).then(resp => {\r\n          if (resp.status == 200) {\r\n            this.singleLoadings.splice(index, 1, false);\r\n            this.getUsers();\r\n          }\r\n        })\r\n      },\r\n\r\n      handleDelete(userId) {\r\n        this.$confirm('删除该用户，是否继续?', '提示', {\r\n          confirmButtonText: '确定',\r\n          cancelButtonText: '取消',\r\n          type: 'warning'\r\n        }).then(() => {\r\n          this.$confirm('该用户下的所有文章、分类、评论均会被删除，是否继续?', '提示', {\r\n            confirmButtonText: '确定',\r\n            cancelButtonText: '取消',\r\n            type: 'info'\r\n          }).then(() => {\r\n            deleteRequest('/admin/user/' + userId).then(resp => {\r\n              if (resp.status == 200) {\r\n                this.getUsers();\r\n              }\r\n            })\r\n          })\r\n        })\r\n      },\r\n\r\n      showRoleIds(roles) {\r\n        this.roleIds = [];\r\n        roles.forEach((item, index) => {\r\n          this.roleIds.push(item.roleId);\r\n        });\r\n      },\r\n\r\n      changeRoles(roleIds, userId, index) {\r\n\r\n        if (roleIds.length == 0) {\r\n          this.$message.error('角色不可为空');\r\n          return false;\r\n        }\r\n        putRequest('/admin/user/roles', {\r\n          roleIds: roleIds,\r\n          userId: userId\r\n        }).then(resp => {\r\n          if (resp.status == 200) {\r\n            this.getUserByUserId(userId, index);\r\n          }\r\n        })\r\n      },\r\n\r\n      getUserByUserId(userId, index) {\r\n        //splice带刷新功能（体验得..\r\n        this.singleLoadings.splice(index, 1, true);\r\n        getRequest('/admin/user/' + userId).then(resp => {\r\n          if (resp.status == 200) {\r\n            this.singleLoadings.splice(index, 1, false);\r\n            this.users.splice(index, 1, resp.data);\r\n          }\r\n        })\r\n      }\r\n\r\n    }\r\n  };\r\n</script>\r\n\r\n<style scoped>\r\n\r\n  .user-manager-body {\r\n    padding: 0px 20px;\r\n  }\r\n\r\n  .input-body {\r\n    width: 30%;\r\n    display: inline-block;\r\n    margin-right: 10px;\r\n  }\r\n\r\n  .delete-button {\r\n    float: right;\r\n    padding: 3px 0;\r\n    color: red;\r\n  }\r\n\r\n\r\n  .form-body {\r\n    padding: 10px;\r\n  }\r\n\r\n  .pText {\r\n    margin-bottom: 15px;\r\n    font-size: 14px;\r\n  }\r\n</style>\r\n"]}]}